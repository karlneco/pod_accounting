{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
  <h1>Order {{ order.order_number }}</h1>

  <!-- Order header info -->
  <dl class="row">
    <dt class="col-sm-3">Date</dt>
    <dd class="col-sm-9">{{ order.order_date }}</dd>

    <dt class="col-sm-3">Customer</dt>
    <dd class="col-sm-9">
      <a href="{{ url_for('customers.list_customers') }}#customer-{{ order.customer.id }}">
        {{ order.customer.name }}
      </a>
    </dd>

    <dt class="col-sm-3">Status</dt>
    <dd class="col-sm-9">{{ order.delivery_status }}</dd>

    <dt class="col-sm-3">Subtotal</dt>
    <dd class="col-sm-9">${{ '%.2f'|format(order.total_amount - (order.shipping or 0) - (order.taxes or 0)) }}</dd>

    <dt class="col-sm-3">Shipping</dt>
    <dd class="col-sm-9">${{ '%.2f'|format(order.shipping or 0) }}</dd>

    <dt class="col-sm-3">Taxes</dt>
    <dd class="col-sm-9">${{ '%.2f'|format(order.taxes or 0) }}</dd>

    <dt class="col-sm-3">Discount</dt>
    <dd class="col-sm-9">${{ '%.2f'|format(order.discount_amount or 0) }}</dd>

    <dt class="col-sm-3">Total</dt>
    <dd class="col-sm-9">${{ '%.2f'|format(order.total_amount) }}</dd>
  </dl>

  <!-- Line items -->
  <h2 class="mt-4">Items</h2>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Product</th>
        <th>Variant</th>
        <th>SKU</th>
        <th>Quantity</th>
        <th>Unit Price</th>
        <th>Subtotal</th>
      </tr>
    </thead>
    <tbody>
      {% for item in order.items %}
      <tr>
        <td>{{ item.product.name if item.product else item.product_sku }}</td>
        <td>{{ item.variant or '-' }}</td>
        <td>{{ item.product_sku }}</td>
        <td>{{ item.quantity }}</td>
        <td>${{ '%.2f'|format(item.unit_price) }}</td>
        <td>${{ '%.2f'|format(item.subtotal) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <a href="{{ url_for('orders.list_orders') }}" class="btn btn-secondary mt-3">
    ‚Üê Back to Orders
  </a>
</div>
{% endblock %}
